# ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸè‡ªåŠ¨åŒ–å®ç°æ€»ç»“

## âœ… å·²å®ç°çš„åŠŸèƒ½

### 1. æ•°æ®æ¨¡å‹æ‰©å±• (`life_system/core/models.py`)

**Task æ¨¡å‹æ–°å¢å­—æ®µï¼š**
- `tags`: JSON åˆ—è¡¨ï¼Œå­˜å‚¨ä»»åŠ¡æ ‡ç­¾
- `category`: åˆ†ç±»ï¼ˆå¦‚ "å¼€å‘/ç»´æŠ¤"ï¼‰
- `priority`: ä¼˜å…ˆçº§ï¼ˆlow/medium/highï¼‰
- `related_task_ids`: å…³è”çš„ç›¸ä¼¼ä»»åŠ¡IDåˆ—è¡¨
- `last_remind_at`: ä¸Šæ¬¡æé†’æ—¶é—´
- `remind_count`: æé†’æ¬¡æ•°
- `deadline`: æˆªæ­¢æ—¥æœŸï¼ˆé¢„ç•™ï¼‰

**æ–°å¢ TaskTransition æ¨¡å‹ï¼š**
- è®°å½•ä»»åŠ¡çŠ¶æ€æµè½¬å†å²
- ç¡®ä¿æ¯ä¸ªä»»åŠ¡éƒ½æœ‰æ˜ç¡®çš„"ç»“å±€"è®°å½•

### 2. åˆ†æå¼•æ“å±‚ (`life_system/engines/`)

**TaskAnalyzer** (`task_analyzer.py`):
- `analyze()`: åˆ†æä»»åŠ¡æ ‡é¢˜ï¼Œæå–å…³é”®è¯ã€åˆ†ç±»ã€ä¼˜å…ˆçº§
- `extract_entities()`: æå–å®ä½“ï¼ˆé¡¹ç›®åç­‰ï¼‰
- çº¯å‡½æ•°å¼ï¼Œæ— å‰¯ä½œç”¨

**SimilarityEngine** (`similarity_engine.py`):
- `similarity_score()`: è®¡ç®—ä¸¤ä¸ªä»»åŠ¡çš„ç›¸ä¼¼åº¦
- `find_similar_tasks()`: æŸ¥æ‰¾ç›¸ä¼¼ä»»åŠ¡
- `is_duplicate()`: æ£€æµ‹é‡å¤ä»»åŠ¡

### 3. æœåŠ¡å±‚æ‰©å±• (`life_system/services/`)

**TaskEnhancementService** (`task_enhancement_service.py`):
- `enhance_task()`: åŸºäºåˆ†æç»“æœæ›´æ–°ä»»åŠ¡å…ƒæ•°æ®
- è‡ªåŠ¨å¡«å…… tagsã€categoryã€priorityã€related_task_ids

**ReminderService** (`reminder_service.py`):
- `remind_pending_tasks()`: æé†’é•¿æœŸæœªæ›´æ–°çš„ pending ä»»åŠ¡ï¼ˆé»˜è®¤7å¤©ï¼‰
- `auto_archive_old_tasks()`: è‡ªåŠ¨å½’æ¡£é•¿æœŸæœªæ›´æ–°çš„ä»»åŠ¡ï¼ˆé»˜è®¤30å¤©ï¼‰

**TransitionService** (`transition_service.py`):
- `record_transition()`: è®°å½•çŠ¶æ€æµè½¬å†å²
- `get_task_history()`: è·å–ä»»åŠ¡çš„çŠ¶æ€æµè½¬å†å²

**TaskService å¢å¼º** (`task_service.py`):
- `process_events()`: ç°åœ¨å¤„ç†å¤šç§äº‹ä»¶ç±»å‹
  - `task.created` â†’ åˆ›å»ºä»»åŠ¡ â†’ è§¦å‘ `task.analyze`
  - `task.analyze` â†’ åˆ†æä»»åŠ¡ â†’ è§¦å‘ `task.analyze.completed`
  - `task.analyze.completed` â†’ å¢å¼ºä»»åŠ¡
  - `task.status.changed` â†’ è®°å½•çŠ¶æ€æµè½¬
- `update_status()`: æ›´æ–°çŠ¶æ€æ—¶è‡ªåŠ¨è®°å½•æµè½¬å†å²

### 4. è°ƒåº¦å™¨æ‰©å±• (`life_system/services/scheduler.py`)

**æ–°å¢å®šæ—¶ä»»åŠ¡ï¼š**
- æ¯å°æ—¶æ£€æŸ¥ pending ä»»åŠ¡ï¼Œå‘é€æé†’ï¼ˆ7å¤©æœªæ›´æ–°ï¼‰
- æ¯å¤©å‡Œæ™¨ 2:00 è‡ªåŠ¨å½’æ¡£é•¿æœŸä»»åŠ¡ï¼ˆ30å¤©æœªæ›´æ–°ï¼‰

## ğŸ”„ å®Œæ•´æµç¨‹ç¤ºä¾‹

### åœºæ™¯ï¼š`life add ä¼˜åŒ–lifeOS`

```
1. ç”¨æˆ·æ‰§è¡Œå‘½ä»¤
   â†“
2. CLI å‘å¸ƒ task.created äº‹ä»¶
   â†“
3. åå° serve å¤„ç†äº‹ä»¶
   â”œâ”€ åˆ›å»º Task(id=1, title="ä¼˜åŒ–lifeOS", status="pending")
   â”œâ”€ è®°å½•çŠ¶æ€æµè½¬: "" â†’ "pending" (reason: "created")
   â””â”€ å‘å¸ƒ task.analyze äº‹ä»¶
   â†“
4. åˆ†æå¼•æ“å¤„ç† task.analyze
   â”œâ”€ æå–å…³é”®è¯: ["ä¼˜åŒ–"]
   â”œâ”€ åˆ†ç±»: "å¼€å‘/ç»´æŠ¤"
   â”œâ”€ ä¼˜å…ˆçº§: "medium"
   â”œâ”€ æŸ¥æ‰¾ç›¸ä¼¼ä»»åŠ¡: å‘ç°ä»»åŠ¡ #5 "é‡æ„lifeOSæ¶æ„" (ç›¸ä¼¼åº¦ 0.75)
   â””â”€ å‘å¸ƒ task.analyze.completed äº‹ä»¶
   â†“
5. ä»»åŠ¡å¢å¼ºæœåŠ¡å¤„ç† task.analyze.completed
   â”œâ”€ æ›´æ–°ä»»åŠ¡å…ƒæ•°æ®:
   â”‚  â”œâ”€ tags: ["ä¼˜åŒ–", "lifeOS"]
   â”‚  â”œâ”€ category: "å¼€å‘/ç»´æŠ¤"
   â”‚  â”œâ”€ priority: "medium"
   â”‚  â””â”€ related_task_ids: [5]
   â””â”€ å‘å¸ƒ task.enhanced äº‹ä»¶
   â†“
6. æŒç»­ç›‘æ§ï¼ˆåå°å®šæ—¶ä»»åŠ¡ï¼‰
   â”œâ”€ æ¯å°æ—¶æ£€æŸ¥: å¦‚æœ7å¤©æœªæ›´æ–° â†’ å‘é€æé†’
   â””â”€ æ¯å¤©å‡Œæ™¨2ç‚¹: å¦‚æœ30å¤©æœªæ›´æ–° â†’ è‡ªåŠ¨å½’æ¡£
```

## ğŸ“Š äº‹ä»¶æµå›¾

```
task.created
    â†“
task.analyze
    â†“
task.analyze.completed
    â†“
task.enhanced
    â†“
(å®šæ—¶æ£€æŸ¥)
    â”œâ”€ task.remind (7å¤©æœªæ›´æ–°)
    â””â”€ task.auto_archive (30å¤©æœªæ›´æ–°)
        â†“
task.status.changed (è®°å½•æµè½¬)
```

## ğŸ¯ å…³é”®è®¾è®¡åŸåˆ™

1. **äº‹ä»¶é©±åŠ¨**: æ‰€æœ‰æ“ä½œé€šè¿‡äº‹ä»¶ä¸²è”ï¼Œå®Œå…¨è§£è€¦
2. **çº¯å‡½æ•°å¼å¼•æ“**: åˆ†æå¼•æ“æ— å‰¯ä½œç”¨ï¼Œæ˜“äºæµ‹è¯•å’Œæ‰©å±•
3. **çŠ¶æ€æµè½¬è®°å½•**: æ¯ä¸ªçŠ¶æ€å˜æ›´éƒ½æœ‰è®°å½•ï¼Œç¡®ä¿ä»»åŠ¡æœ‰"ç»“å±€"
4. **è‡ªåŠ¨åŒ–é—­ç¯**: ä»åˆ›å»ºåˆ°å½’æ¡£ï¼Œå…¨ç¨‹è‡ªåŠ¨åŒ–å¤„ç†

## ğŸš€ ä½¿ç”¨æ–¹æ³•

1. **å¯åŠ¨åå°æœåŠ¡**:
   ```bash
   life serve
   ```

2. **æ·»åŠ ä»»åŠ¡**:
   ```bash
   life add ä¼˜åŒ–lifeOS
   ```

3. **æŸ¥çœ‹ä»»åŠ¡**ï¼ˆä¼šè‡ªåŠ¨æ˜¾ç¤ºå¢å¼ºåçš„å…ƒæ•°æ®ï¼‰:
   ```bash
   life list
   ```

4. **æŸ¥çœ‹ä»»åŠ¡å†å²**:
   ```python
   from life_system.services.transition_service import TransitionService
   service = TransitionService()
   history = service.get_task_history(task_id=1)
   ```

## ğŸ”® æœªæ¥æ‰©å±•æ–¹å‘

1. **AI å¢å¼º**: ä½¿ç”¨ LLM è¿›è¡Œæ›´æ™ºèƒ½çš„ä»»åŠ¡åˆ†æå’Œåˆ†ç±»
2. **æ™ºèƒ½æé†’**: åŸºäºä»»åŠ¡ä¼˜å…ˆçº§å’Œæˆªæ­¢æ—¥æœŸï¼Œæ™ºèƒ½è°ƒæ•´æé†’é¢‘ç‡
3. **ä»»åŠ¡å…³è”**: è‡ªåŠ¨å‘ç°ä»»åŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»
4. **é¢„æµ‹åˆ†æ**: åŸºäºå†å²æ•°æ®é¢„æµ‹ä»»åŠ¡å®Œæˆæ—¶é—´
5. **é€šçŸ¥é›†æˆ**: æ¡Œé¢é€šçŸ¥ã€é‚®ä»¶ã€å¾®ä¿¡ç­‰

